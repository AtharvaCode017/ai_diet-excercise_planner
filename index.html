<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Workout Planner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Montserrat', 'sans-serif'],
                    },
                    colors: {
                        cultDark: '#0f1014', // Cult.fit dark background
                        cultCard: '#1d1e24',
                        cultAccent: '#ff3278', // Cult pink/red accent
                        cultGradientStart: '#ff4557',
                        cultGradientEnd: '#ff2d88',
                    },
                    animation: {
                        'pop-up': 'popUp 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards',
                        'fade-in': 'fadeIn 0.6s ease-out forwards',
                    },
                    keyframes: {
                        popUp: {
                            '0%': { opacity: '0', transform: 'scale(0.9) translateY(20px)' },
                            '100%': { opacity: '1', transform: 'scale(1) translateY(0)' },
                        },
                        fadeIn: {
                            '0%': { opacity: '0', transform: 'translateY(10px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #0f1014;
            color: white;
            background-image: radial-gradient(circle at 10% 20%, rgba(255, 50, 120, 0.1) 0%, transparent 20%),
                              radial-gradient(circle at 90% 80%, rgba(59, 130, 246, 0.1) 0%, transparent 20%);
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #0f1014;
        }
        ::-webkit-scrollbar-thumb {
            background: #374151;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #ff3278;
        }

        /* Glassmorphism Input Fields */
        .glass-input {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            color: white;
        }
        .glass-input:focus {
            background: rgba(255, 255, 255, 0.1);
            border-color: #ff3278;
            outline: none;
            box-shadow: 0 0 15px rgba(255, 50, 120, 0.3);
            transform: translateY(-2px);
        }

        /* Loader */
        .loader {
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-top: 4px solid #ff3278;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 30px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Plan Output Styling */
        #plan-content-wrapper {
             background: linear-gradient(145deg, #1d1e24, #16171b);
             padding: 2.5rem;
             border: 1px solid rgba(255, 255, 255, 0.05);
             color: #e5e7eb;
        }
        #plan-content table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin-top: 1.5rem;
            margin-bottom: 2rem;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        #plan-content th {
            background: #ff3278;
            color: white;
            padding: 1rem;
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 0.05em;
        }
        #plan-content td {
            background: rgba(255,255,255,0.03);
            border-bottom: 1px solid rgba(255,255,255,0.05);
            padding: 1rem;
            transition: background 0.2s;
        }
        #plan-content tr:hover td {
            background: rgba(255,255,255,0.08);
        }
        #plan-content h3 {
            font-size: 2rem;
            font-weight: 800;
            background: linear-gradient(to right, #ff3278, #ff9068);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1.5rem;
            text-align: center;
            text-transform: uppercase;
        }
        #plan-content h4 {
            font-size: 1.5rem;
            font-weight: 700;
            color: white;
            margin-top: 2rem;
            margin-bottom: 1rem;
            border-left: 4px solid #ff3278;
            padding-left: 1rem;
        }
        #plan-content ul {
            list-style-type: none;
            padding-left: 0;
        }
        #plan-content li {
            position: relative;
            padding-left: 1.5rem;
            margin-bottom: 0.5rem;
            color: #d1d5db;
        }
        #plan-content li::before {
            content: "•";
            color: #ff3278;
            font-weight: bold;
            position: absolute;
            left: 0;
        }

        /* BMI Visualizer Overrides for Dark Mode */
        .bmi-visualizer {
            width: 300px;
            height: 150px;
            position: relative;
            margin: 2rem auto;
        }
        .bmi-gauge-cover {
            background: #1d1e24; /* Match card background */
        }
        .bmi-center-circle {
            background: white;
            box-shadow: 0 0 10px rgba(255,255,255,0.5);
        }
        .bmi-needle {
            background: white;
            box-shadow: 0 0 5px rgba(255,255,255,0.5);
        }
        .bmi-label {
            color: #9ca3af;
        }
        
    </style>
</head>
<body class="min-h-screen flex flex-col antialiased">

    <nav class="w-full py-4 px-8 flex justify-between items-center border-b border-gray-800 bg-opacity-50 backdrop-blur-md sticky top-0 z-50">
        <div class="text-2xl font-bold tracking-tighter text-white">
            FIT<span class="text-cultAccent">PLANNER</span><span class="text-xs align-top opacity-70">AI</span>
        </div>
        <div class="hidden md:flex space-x-6 text-sm font-semibold text-gray-300">
            <a href="#" class="hover:text-white transition-colors">FITNESS</a>
            <a href="#" class="hover:text-white transition-colors">CARE</a>
            <a href="#" class="hover:text-white transition-colors">MIND</a>
        </div>
        <button class="bg-white text-black px-4 py-2 rounded-full font-bold text-xs hover:bg-gray-200 transition-transform hover:scale-105">
            GET APP
        </button>
    </nav>

    <div class="container mx-auto p-4 md:p-8 max-w-5xl flex-grow">
        
        <header class="text-center mb-12 animate-fade-in">
            <h1 class="text-4xl md:text-6xl font-extrabold tracking-tight mb-4 leading-tight">
                ONE MEMBERSHIP <br>
                <span class="text-transparent bg-clip-text bg-gradient-to-r from-cultGradientStart to-orange-400">
                    FOR YOUR TRANSFORMATION
                </span>
            </h1>
            <p class="text-lg text-gray-400 max-w-2xl mx-auto">
                Generate a personalized, AI-powered workout and diet plan tailored specifically to your Indian diet preferences and fitness goals.
            </p>
        </header>

        <main>
            <div class="bg-cultCard p-8 rounded-3xl shadow-2xl border border-gray-800 relative overflow-hidden animate-fade-in" style="animation-delay: 0.1s;">
                <div class="absolute -top-20 -right-20 w-64 h-64 bg-cultAccent opacity-10 rounded-full blur-3xl pointer-events-none"></div>

                <form id="workout-form">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 relative z-10">
                        <div class="col-span-1 group">
                            <label for="age" class="block text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 group-hover:text-cultAccent transition-colors">Age</label>
                            <input type="number" id="age" name="age" min="8" max="100" class="glass-input w-full rounded-xl px-4 py-3" placeholder="e.g., 24" required>
                        </div>
                        <div class="col-span-1 group">
                            <label for="gender" class="block text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 group-hover:text-cultAccent transition-colors">Gender</label>
                            <select id="gender" name="gender" class="glass-input w-full rounded-xl px-4 py-3" required>
                                <option class="text-black">Male</option>
                                <option class="text-black">Female</option>
                                <option class="text-black">Other</option>
                            </select>
                        </div>
                        <div class="col-span-1 group">
                            <label for="weight" class="block text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 group-hover:text-cultAccent transition-colors">Weight (kg)</label>
                            <input type="number" id="weight" name="weight" min="1" class="glass-input w-full rounded-xl px-4 py-3" placeholder="e.g., 70" required>
                        </div>
                        <div class="col-span-1 group">
                            <label for="height" class="block text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 group-hover:text-cultAccent transition-colors">Height (cm)</label>
                            <input type="number" id="height" name="height" min="1" class="glass-input w-full rounded-xl px-4 py-3" placeholder="e.g., 175" required>
                        </div>

                        <div class="col-span-1 group">
                            <label for="experience" class="block text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 group-hover:text-cultAccent transition-colors">Experience</label>
                            <select id="experience" name="experience" class="glass-input w-full rounded-xl px-4 py-3" required>
                                <option class="text-black">Beginner</option>
                                <option class="text-black">Regular</option>
                                <option class="text-black">Advanced</option>
                            </select>
                        </div>
                        <div class="col-span-1 group">
                            <label for="workout-mode" class="block text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 group-hover:text-cultAccent transition-colors">Mode</label>
                            <select id="workout-mode" name="workout-mode" class="glass-input w-full rounded-xl px-4 py-3" required>
                                <option class="text-black">Home</option>
                                <option class="text-black">Cardio</option>
                                <option class="text-black">Weight Training</option>
                            </select>
                        </div>
                        <div class="col-span-1 group">
                            <label for="goal" class="block text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 group-hover:text-cultAccent transition-colors">Goal</label>
                            <select id="goal" name="goal" class="glass-input w-full rounded-xl px-4 py-3" required>
                                <option class="text-black">Fat Loss</option>
                                <option class="text-black">Strength Training</option>
                                <option class="text-black">Muscle Building</option>
                                <option class="text-black">Weight Gain</option>
                            </select>
                        </div>
                         <div class="col-span-1 md:col-span-2 group">
                            <label for="diet-preference" class="block text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 group-hover:text-cultAccent transition-colors">Diet Preference</label>
                            <select id="diet-preference" name="diet-preference" class="glass-input w-full rounded-xl px-4 py-3" required>
                                <option class="text-black">Anything</option>
                                <option class="text-black">Vegetarian</option>
                                <option class="text-black">Non-Vegetarian</option>
                                <option class="text-black">Vegan</option>
                            </select>
                        </div>
                    </div>

                    <div id="bmi-info-container" class="mt-8 text-center hidden animate-pop-up">
                        <div class="inline-block p-4 rounded-2xl bg-black/20 border border-white/10">
                            <p id="bmi-text" class="text-sm font-semibold text-cultAccent mb-2"></p>
                            <div class="bmi-visualizer">
                                <div class="bmi-gauge"></div>
                                <div class="bmi-gauge-cover"></div>
                                <div class="bmi-label" style="transform: rotate(-68deg); --inner-rotation: 68deg;">
                                    <span><span class="category text-blue-400">Under</span><br>&lt;18.5</span>
                                </div>
                                <div class="bmi-label" style="transform: rotate(-32deg); --inner-rotation: 32deg;">
                                    <span><span class="category text-green-400">Normal</span><br>18.5-25</span>
                                </div>
                                 <div class="bmi-label" style="transform: rotate(8deg); --inner-rotation: -8deg;">
                                    <span><span class="category text-yellow-400">Over</span><br>25-30</span>
                                </div>
                                 <div class="bmi-label" style="transform: rotate(45deg); --inner-rotation: -45deg;">
                                    <span><span class="category text-orange-400">Obese</span><br>30-35</span>
                                </div>
                                 <div class="bmi-label" style="transform: rotate(80deg); --inner-rotation: -80deg;">
                                    <span><span class="category text-red-500">Extreme</span><br>&gt;35</span>
                                </div>
                                <div class="bmi-needle" id="bmi-needle"></div>
                                <div class="bmi-center-circle"></div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-8 text-center">
                        <button type="submit" id="generate-btn" class="w-full md:w-auto relative inline-flex items-center justify-center px-10 py-4 overflow-hidden font-bold text-white rounded-full bg-gradient-to-r from-cultGradientStart to-orange-500 hover:from-pink-600 hover:to-orange-600 transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-[0_0_20px_rgba(255,50,120,0.5)] group">
                            <span class="absolute w-0 h-0 transition-all duration-500 ease-out bg-white rounded-full opacity-10 group-hover:w-56 group-hover:h-56"></span>
                            <span class="relative">GENERATE MY PLAN</span>
                            <svg class="w-5 h-5 ml-2 -mr-1 transition-transform duration-300 transform group-hover:translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                        </button>
                    </div>
                </form>
            </div>

            <div id="workout-plan" class="mt-12 hidden">
                 <div class="download-buttons flex justify-center gap-4 mb-6 animate-fade-in" id="download-buttons">
                    <button id="download-jpg" class="flex items-center px-6 py-2 border border-gray-600 rounded-full text-sm font-bold text-gray-300 hover:text-white hover:border-white hover:bg-white/10 transition-all hover:scale-105">
                        DOWNLOAD JPG
                    </button>
                    <button id="download-pdf" class="flex items-center px-6 py-2 border border-cultAccent rounded-full text-sm font-bold text-cultAccent hover:bg-cultAccent hover:text-white transition-all hover:scale-105 hover:shadow-[0_0_15px_rgba(255,50,120,0.4)]">
                        DOWNLOAD PDF
                    </button>
                </div>
                
                <div id="plan-content-wrapper" class="rounded-3xl shadow-2xl animate-pop-up">
                    <div id="plan-content"></div>
                </div>
                
                <div id="loader" class="loader hidden"></div>
            </div>
        </main>
        
        <div id="error-modal" class="fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[100] hidden transition-opacity duration-300">
            <div class="bg-gray-900 border border-gray-700 p-8 rounded-2xl max-w-sm w-full text-center shadow-2xl transform scale-100 animate-pop-up">
                <div class="text-cultAccent mb-4">
                    <svg class="w-12 h-12 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>
                </div>
                <h3 id="modal-title" class="text-xl font-bold text-white mb-2">Error</h3>
                <p id="modal-message" class="text-gray-400 mb-6 text-sm"></p>
                <button id="close-modal" class="px-6 py-2 bg-white text-black font-bold rounded-full hover:bg-gray-200 transition-colors">CLOSE</button>
            </div>
        </div>

        <footer class="text-center mt-12 py-6 border-t border-gray-800 text-xs text-gray-600">
            <p>POWERED BY GEMINI AI • © 2026 ATHARVA RAHANE</p>
        </footer>
    </div>

    <script>
        const form = document.getElementById('workout-form');
        const workoutPlanDiv = document.getElementById('workout-plan');
        const planContentDiv = document.getElementById('plan-content');
        const loader = document.getElementById('loader');
        const generateBtn = document.getElementById('generate-btn');
        const downloadButtons = document.getElementById('download-buttons');
        const bmiInfoContainer = document.getElementById('bmi-info-container');
        const bmiText = document.getElementById('bmi-text');
        const bmiNeedle = document.getElementById('bmi-needle');
        const errorModal = document.getElementById('error-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalMessage = document.getElementById('modal-message');
        const closeModalBtn = document.getElementById('close-modal');

        function showModal(title, message) {
            modalTitle.textContent = title;
            modalMessage.textContent = message;
            errorModal.classList.remove('hidden');
        }

        closeModalBtn.addEventListener('click', () => {
            errorModal.classList.add('hidden');
        });
        errorModal.addEventListener('click', (e) => {
            if (e.target === errorModal) {
                errorModal.classList.add('hidden');
            }
        });

        function updateBmiInfo() {
            const weight = parseFloat(document.getElementById('weight').value);
            const height = parseFloat(document.getElementById('height').value);
            if (weight > 0 && height > 0) {
                const heightInMeters = height / 100;
                const bmi = (weight / (heightInMeters * heightInMeters));
                bmiText.innerHTML = `BMI: <span class="text-white text-lg">${bmi.toFixed(1)}</span>`;
                bmiInfoContainer.classList.remove('hidden');
                
                let rotation = -90; 
                if (bmi < 12) rotation = -90;
                else if (bmi > 40) rotation = 90;
                else {
                    rotation = ((bmi - 12) / (40 - 12)) * 180 - 90;
                }
                bmiNeedle.style.transform = `translateX(-50%) rotate(${rotation}deg)`;
            } else {
                bmiInfoContainer.classList.add('hidden');
            }
        }

        document.getElementById('weight').addEventListener('input', updateBmiInfo);
        document.getElementById('height').addEventListener('input', updateBmiInfo);

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const age = parseInt(document.getElementById('age').value);
            const weight = parseFloat(document.getElementById('weight').value);
            const height = parseFloat(document.getElementById('height').value);
            const goal = document.getElementById('goal').value;

            if (isNaN(age) || age < 8 || age > 100) {
                showModal('Invalid Age', 'Please enter a valid age between 8 and 100.');
                return;
            }
            if (isNaN(weight) || weight <= 0) {
                showModal('Invalid Weight', 'Please enter a positive number for weight.');
                return;
            }
            if (isNaN(height) || height <= 0) {
                showModal('Invalid Height', 'Please enter a positive number for height.');
                return;
            }

            const heightInMeters = height / 100;
            const bmi = weight / (heightInMeters * heightInMeters);

            if (bmi < 16.5 && goal === 'Fat Loss') {
                showModal('Safety Warning', `Your BMI is critically low (${bmi.toFixed(1)}). 'Fat Loss' is unsafe. Please select 'Muscle Building' or 'Weight Gain'.`);
                return;
            }
            if (bmi > 35 && goal === 'Weight Gain') {
                showModal('Safety Warning', `Your BMI is critically high (${bmi.toFixed(1)}). 'Weight Gain' is unsafe. Please select 'Fat Loss' or consult a doctor.`);
                return;
            }

            workoutPlanDiv.classList.remove('hidden');
            loader.classList.remove('hidden');
            downloadButtons.style.display = 'none';
            planContentDiv.innerHTML = '';
            
            // Button loading state
            const originalBtnText = generateBtn.innerHTML;
            generateBtn.disabled = true;
            generateBtn.innerHTML = '<span class="animate-pulse">GENERATING PLAN...</span>';
            generateBtn.classList.add('opacity-75', 'cursor-not-allowed');

            const formData = new FormData(form);
            const gender = formData.get('gender');
            const experience = formData.get('experience');
            const workoutMode = formData.get('workout-mode');
            const dietPreference = formData.get('diet-preference');

            const prompt = `
                Create a concise, poster-style fitness plan for a ${age}-year-old ${gender} with a ${experience} experience level, weighing ${weight}kg and ${height}cm tall (BMI: ${bmi.toFixed(1)}).
                The primary goal is ${goal}. The workout mode is ${workoutMode}. The diet preference is ${dietPreference}.
                
                CRITICAL INSTRUCTIONS:
                1. The diet plan must be STRICTLY Indian (Indian Subcontinent style). Use terms like Roti, Chapati, Dal, Sabzi, Rice, Curd, Idli, Dosa, Paneer, etc.
                2. Do NOT include Beef or Pork in any option.
                3. The workout exercises and intensity should be appropriate for the user's experience level.
                4. The entire output must be in Markdown format, clean, and well-structured for a downloadable poster.

                Start with a main heading: ### Your Weekly Fitness Poster

                Then, create a section for the diet plan.
                #### Diet Plan (Indian Style)
                - Create a Markdown table with columns: "Meal", and "Options". 
                - Provide 3-4 meal options per row. 
                - Focus on home-cooked Indian foods available in the Indian subcontinent.

                Next, create a section for the workout schedule.
                #### Weekly Workout Schedule
                - Create a Markdown table for the 7-day week. The columns should be: "Day", "Focus/Activity", "Exercises", and "Sets & Reps".
                - Include 3 workout days and 4 rest/active recovery days.
                - For workout days, list 3-4 key exercises in the "Exercises" column appropriate for the experience level. Use commas to separate them.
                - For rest days, suggest an activity like "Rest" or "Light Walk".
            `;

            try {
                const generatedText = await generateText(prompt);
                const htmlContent = parseMarkdown(generatedText);
                planContentDiv.innerHTML = htmlContent;
                downloadButtons.style.display = 'flex';
                
                // Scroll to result smoothly
                workoutPlanDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });

            } catch (error) {
                console.error('Error generating workout plan:', error);
                planContentDiv.innerHTML = '<p class="text-red-500 text-center p-4">Sorry, we couldn\'t generate a plan at this time. Please try again later.</p>';
            } finally {
                loader.classList.add('hidden');
                generateBtn.disabled = false;
                generateBtn.innerHTML = originalBtnText;
                generateBtn.classList.remove('opacity-75', 'cursor-not-allowed');
            }
        });

        function parseMarkdown(text) {
            const lines = text.split('\n');
            let html = '';
            let inTable = false;

            for (const line of lines) {
                let processedLine = line.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');

                if (processedLine.startsWith('### ')) {
                    if (inTable) { html += '</tbody></table>'; inTable = false; }
                    html += `<h3>${processedLine.substring(4)}</h3>`;
                } else if (processedLine.startsWith('#### ')) {
                    if (inTable) { html += '</tbody></table>'; inTable = false; }
                    html += `<h4>${processedLine.substring(5)}</h4>`;
                } else if (processedLine.startsWith('- ')) {
                    if (inTable) { html += '</tbody></table>'; inTable = false; }
                    if (!html.endsWith('</ul>')) { html += '<ul>'; }
                    html += `<li>${processedLine.substring(2)}</li>`;
                    if (lines.indexOf(line) === lines.length - 1 || !lines[lines.indexOf(line) + 1].startsWith('- ')) {
                         html += '</ul>';
                    }
                } else if (processedLine.includes('|')) {
                    const columns = processedLine.split('|').map(s => s.trim()).filter(Boolean);
                    if (columns.length === 0) continue;

                    if (!inTable && !processedLine.includes('---')) {
                        html += '<table><thead><tr>';
                        columns.forEach(col => { html += `<th>${col}</th>`; });
                        html += '</tr></thead><tbody>';
                        inTable = true;
                    } else if (inTable && !processedLine.includes('---')) {
                        html += '<tr>';
                        columns.forEach(col => { html += `<td>${col.replace(/, /g, '<br>')}</td>`; }); 
                        html += '</tr>';
                    }
                } else {
                     if (inTable) { html += '</tbody></table>'; inTable = false; }
                     if (processedLine.trim()) { html += `<p>${processedLine}</p>`; }
                }
            }
            if (inTable) { html += '</tbody></table>'; }
            return html;
        }

        document.getElementById('download-jpg').addEventListener('click', () => {
            const planElement = document.getElementById('plan-content-wrapper');
            html2canvas(planElement, { scale: 2, backgroundColor: '#1d1e24' }).then(canvas => {
                const link = document.createElement('a');
                link.download = 'workout-plan.jpg';
                link.href = canvas.toDataURL('image/jpeg');
                link.click();
            });
        });

        document.getElementById('download-pdf').addEventListener('click', () => {
            const { jsPDF } = window.jspdf;
            const planElement = document.getElementById('plan-content-wrapper');
            
            html2canvas(planElement, { scale: 2, backgroundColor: '#1d1e24' }).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const pdf = new jsPDF({
                    orientation: 'portrait',
                    unit: 'px',
                    format: [canvas.width, canvas.height]
                });
                pdf.addImage(imgData, 'PNG', 0, 0, canvas.width, canvas.height);
                pdf.save('workout-plan.pdf');
            });
        });

    async function generateText(prompt) {
        // Updated URL
        const response = await fetch(
            "https://ai-diet-excercise-planner.onrender.com/generate",
        {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({ prompt })
        }
    );

    if (!response.ok) {
        throw new Error("Backend request failed");
    }

    const data = await response.json();
    return data.text;
}
    </script>
</body>
</html>
